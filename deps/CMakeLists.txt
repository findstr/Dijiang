cmake_minimum_required(VERSION 3.22)
PROJECT(deps)
set(lib_folder "libs")
set(BUILD_SHARED_LIBS OFF CACHE BOOL "" FORCE)

if(NOT TARGET imgui)
    include(imgui.cmake)
    set_target_properties(imgui PROPERTIES FOLDER ${lib_folder})
endif()

if(NOT TARGET glm)
    option(BUILD_STATIC_LIBS "" ON)
    option(BUILD_TESTING "" OFF)
    option(GLM_TEST_ENABLE "" OFF)
    add_subdirectory(glm)
    set_target_properties(glm_static PROPERTIES FOLDER ${lib_folder})
endif()

if (NOT TARGET assimp)
	option(BUILD_STATIC_LIBS "" ON)
	add_subdirectory(assimp)
	if (CMAKE_HOST_WIN32)
		target_compile_options(assimp INTERFACE /EHsc)
	endif()
	set_target_properties(assimp PROPERTIES FOLDER ${lib_folder})
	set_target_properties(assimp_cmd PROPERTIES FOLDER ${lib_folder})
	set_target_properties(zlibstatic PROPERTIES FOLDER ${lib_folder})
	set_target_properties(UpdateAssimpLibsDebugSymbolsAndDLLs PROPERTIES FOLDER ${lib_folder})
endif()

if (NOT TARGET yaml-cpp)
	option(BUILD_STATIC_LIBS "" ON)
	add_subdirectory(yaml-cpp)
	set_target_properties(yaml-cpp PROPERTIES FOLDER ${lib_folder})
	set_target_properties(yaml-cpp-read PROPERTIES FOLDER ${lib_folder})
	set_target_properties(yaml-cpp-parse PROPERTIES FOLDER ${lib_folder})
	set_target_properties(yaml-cpp-sandbox PROPERTIES FOLDER ${lib_folder})
endif()

if(NOT TARGET SDL-static)
    add_subdirectory(SDL2)
endif()

if (NOT TARGET vk_mem)
	include(vk_mem.cmake)
	set_target_properties(vk_mem PROPERTIES FOLDER ${lib_folder})
endif()
if (NOT TARGET stb)
	include(stb.cmake)
	set_target_properties(stb PROPERTIES FOLDER ${lib_folder})
endif()

if (NOT TARGET ktx)
	include(ktx.cmake)
	add_definitions(-DVK_USE_PLATFORM_WIN32_KHR)
	set_target_properties(ktx PROPERTIES FOLDER ${lib_folder})
endif()

if (NOT TARGET spirv-cross)
	add_subdirectory(spirv-cross)
	option(SPIRV_CROSS_STATIC  "" ON)
	set_target_properties(spirv-cross PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-c PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-core PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-cpp PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-reflect PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-hlsl PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-glsl PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-msl PROPERTIES FOLDER ${lib_folder})
	set_target_properties(spirv-cross-util PROPERTIES FOLDER ${lib_folder})
endif()


set(BUILD_SHARED_LIBS ON CACHE BOOL "" FORCE)
if (NOT TARGET lua)
	add_subdirectory(lua)
	set(LUA_ENABLE_SHARED 1)
	set_target_properties(lua PROPERTIES FOLDER ${lib_folder})
	set_target_properties(lua PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${ROOT_DIR}/bin)
endif()

